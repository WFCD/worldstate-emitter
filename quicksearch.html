<html>
<head>
</head>
<body style="background: transparent;">
    <script src="scripts/docstrap.lib.js"></script>
    <script src="scripts/lunr.min.js"></script>
    <script src="scripts/fulltext-search.js"></script>

    <script type="text/x-docstrap-searchdb">
    {"handlers_events_cycleLike.js.html":{"id":"handlers_events_cycleLike.js.html","title":"Source: handlers/events/cycleLike.js","body":" Worldstate Emitter Classes module.exports Global arbitrationbetweendataemitfromNowgetgetDatagetParseableDatagroupByinitCycleStartlastUpdatedonErrorparseEventssetUpRawEmitterssetupParsedEventstwitterupdate Source: handlers/events/cycleLike.js import { between, lastUpdated, fromNow } from '../../utilities/index.js'; /** * @typedef {Object} CycleLike * @property {string} state * @property {string} key * @property {Date} activation */ /** * CylceData parser * @param {CycleLike} cycleData data for parsing all cycles like this * @param {Deps} deps dependencies for processing * @returns {Object[]} */ export default (cycleData, deps) =&gt; { const packet = { ...deps, data: cycleData, id: `${deps.key.replace('Cycle', '')}.${cycleData.state}`, }; const last = new Date(lastUpdated[deps.platform][deps.language]); const activation = new Date(cycleData.activation); const start = new Date(deps.cycleStart); const packets = []; if (between(last, activation, start)) { packets.push(packet); } const timePacket = { ...packet, id: `${packet.id}.${Math.round(fromNow(deps.data.expiry) / 60000)}`, }; packets.push(timePacket); return packets; }; × Search results Close "},"handlers_events_parse.js.html":{"id":"handlers_events_parse.js.html","title":"Source: handlers/events/parse.js","body":" Worldstate Emitter Classes module.exports Global arbitrationbetweendataemitfromNowgetgetDatagetParseableDatagroupByinitCycleStartlastUpdatedonErrorparseEventssetUpRawEmitterssetupParsedEventstwitterupdate Source: handlers/events/parse.js import { lastUpdated } from '../../utilities/index.js'; import checkOverrides from './checkOverrides.js'; import kuvaProcessing from './kuva.js'; import arrayLike from './arrayLike.js'; import objectLike from './objectLike.js'; import nightwave from './nightwave.js'; import cycleLike from './cycleLike.js'; import * as eKeyOverrides from './eKeyOverrides.js'; /** * @typedef {Object} Deps * @property {string} key event key being parsed * @property {string} platform platform the event is on * @property {string} language language the event is in * @property {Date} cycleStart start of the current cycle * @property {Object|Array} data data to parse */ /** * Set up current cycle start if it's not been initiated * @param {Deps} deps dependencies for processing */ const initCycleStart = (deps) =&gt; { if (!lastUpdated[deps.platform][deps.language]) { lastUpdated[deps.platform][deps.language] = deps.cycleStart; } }; /** * Parse new events from the provided worldstate * @param {Deps} deps dependencies to parse out events * @returns {Packet|Packet[]} packet(s) to emit */ export default (deps) =&gt; { initCycleStart(deps); // anything in the eKeyOverrides goes first, then anything uniform const packets = []; switch (deps.key) { case 'kuva': return kuvaProcessing(deps, packets); case 'events': deps = { ...deps, id: eKeyOverrides[deps.key], }; case 'alerts': case 'conclaveChallenges': case 'dailyDeals': case 'flashSales': case 'fissures': case 'globalUpgrades': case 'invasions': case 'syndicateMissions': case 'weeklyChallenges': packets.push(...arrayLike(deps, packets)); break; case 'cetusCycle': case 'earthCycle': case 'vallisCycle': packets.push(cycleLike(deps.data, deps)); break; case 'persistentEnemies': deps = { ...deps, ...checkOverrides(deps.key, deps.data), }; case 'sortie': case 'voidTrader': case 'arbitration': case 'sentientOutposts': deps.id = checkOverrides(deps.key, deps.data); packets.push(objectLike(deps.data, deps)); case 'nightwave': packets.push(nightwave(deps.data, deps)); default: break; } return packets; }; × Search results Close "},"handlers_events_eKeyOverrides.js.html":{"id":"handlers_events_eKeyOverrides.js.html","title":"Source: handlers/events/eKeyOverrides.js","body":" Worldstate Emitter Classes module.exports Global arbitrationbetweendataemitfromNowgetgetDatagetParseableDatagroupByinitCycleStartlastUpdatedonErrorparseEventssetUpRawEmitterssetupParsedEventstwitterupdate Source: handlers/events/eKeyOverrides.js import { logger } from '../../utilities/index.js'; /** * External mission data retrieved from https://10o.io/kuvalog.json * @typedef {Object} ExternalMission * @property {Date} activation start time * @property {Date} expiry end timer * @property {string} node formatted node name with planet * @property {string} enemy Enemy on tile * @property {string} type Mission type of node * @property {boolean} archwing whether or not the tile requires archwing * @property {boolean} sharkwing whether or not the tile requires * sumbersible archwing */ export const fissures = (fissure) =&gt; `fissures.t${fissure.tierNum}.${(fissure.missionType || '').toLowerCase()}`; export const enemies = (acolyte) =&gt; ({ eventKey: `enemies${acolyte.isDiscovered ? '' : '.departed'}`, activation: acolyte.lastDiscoveredAt, }); /** * Parse an arbitration for its key * @param {ExternalMission} arbi arbitration data to parse * @returns {string} */ export const arbitration = (arbi) =&gt; { if (!arbi?.enemy) return ''; let k; try { k = `arbitration.${arbi.enemy.toLowerCase()}.${arbi.type.replace(/\\s/g, '').toLowerCase()}`; } catch (e) { logger.error(`Unable to parse arbitraion: ${JSON.stringify(arbi)}\\n${e}`); } return k; }; export const events = 'operations'; export const persistentEnemies = 'enemies'; × Search results Close "},"utilities_index.js.html":{"id":"utilities_index.js.html","title":"Source: utilities/index.js","body":" Worldstate Emitter Classes module.exports Global arbitrationbetweendataemitfromNowgetgetDatagetParseableDatagroupByinitCycleStartlastUpdatedonErrorparseEventssetUpRawEmitterssetupParsedEventstwitterupdate Source: utilities/index.js import { transports, createLogger, format } from 'winston'; import { LOG_LEVEL } from './env.js'; let tempLogger; try { const { combine, label, printf, colorize } = format; /* Logger setup */ const transport = new transports.Console(); const logFormat = printf((info) =&gt; `[${info.label}] ${info.level}: ${info.message}`); tempLogger = createLogger({ format: combine(colorize(), label({ label: 'WS'.brightBlue }), logFormat), transports: [transport], }); tempLogger.level = LOG_LEVEL; } catch (e) { tempLogger = console; } export const logger = tempLogger; /** * Group an array by a field value * @param {Object[]} array array of objects to broup * @param {string} field field to group by * @returns {Object} [description] */ export const groupBy = (array, field) =&gt; { const grouped = {}; if (!array) return undefined; array.forEach((item) =&gt; { const fVal = item[field]; if (!grouped[fVal]) { grouped[fVal] = []; } grouped[fVal].push(item); }); return grouped; }; const allowedDeviation = 30000; /** * Validate that b is between a and c * @param {Date} a The first Date, should be the last time things were updated * @param {Date} b The second Date, should be the activation time of an event * @param {Date} c The third Date, should be the start time of this update cycle * @returns {boolean} if the event date is between the server start time and the last update time */ export const between = (a, b, c = new Date()) =&gt; b + allowedDeviation &gt; a &amp;&amp; b - allowedDeviation &lt; c; /** * Returns the number of milliseconds between now and a given date * @param {string} d The date from which the current time will be subtracted * @param {function} [now] A function that returns the current UNIX time in milliseconds * @returns {number} */ export function fromNow(d, now = Date.now) { return new Date(d).getTime() - now(); } /** * Map of last updated dates/times * @type {Object} */ export const lastUpdated = { pc: { en: 0, // Date.now(), }, ps4: { en: Date.now(), }, xb1: { en: Date.now(), }, swi: { en: Date.now(), }, }; × Search results Close "},"utilities_WSCache.js.html":{"id":"utilities_WSCache.js.html","title":"Source: utilities/WSCache.js","body":" Worldstate Emitter Classes module.exports Global arbitrationbetweendataemitfromNowgetgetDatagetParseableDatagroupByinitCycleStartlastUpdatedonErrorparseEventssetUpRawEmitterssetupParsedEventstwitterupdate Source: utilities/WSCache.js import WorldState from 'warframe-worldstate-parser'; import { logger } from './index.js'; /** * Warframe WorldState Cache - store and retrieve current worldstate data */ export default class WSCache { #inner; #kuvaCache; #sentientCache; #logger = logger; #emitter; /** @type string */ #platform = 'pc'; /** @type string */ #language; /** * Set up a cache checking for data and updates to a specific worldstate set * @param {string} language Language/translation to track * @param {Cache} kuvaCache Cache of kuva data, provided by Semlar * @param {Cache} sentientCache Cache of sentient outpost data, provided by Semlar * @param {EventEmitter} eventEmitter Emitter to push new worldstate updates to */ constructor({ language, kuvaCache, sentientCache, eventEmitter }) { this.#inner = undefined; this.#kuvaCache = kuvaCache; this.#sentientCache = sentientCache; this.#language = language; this.#emitter = eventEmitter; } /** * Update the current data with new data * @param {string} newData updated worldstate data * @returns {Promise&lt;void&gt;} */ #update = async (newData) =&gt; { const deps = { locale: this.#language, kuvaData: {}, sentientData: {}, }; try { deps.kuvaData = JSON.parse(await this.#kuvaCache.get()); } catch (err) { logger.debug(`Error parsing kuva data for ${this.#language}: ${err}`); } try { deps.sentientData = JSON.parse(await this.#sentientCache.get()); } catch (err) { logger.warn(`Error parsing sentient data for ${this.#language}: ${err}`); } let t; try { t = await WorldState.build(newData, deps); if (!t.timestamp) return; } catch (err) { this.#logger.warn(`Error parsing worldstate data for ${this.#language}: ${err}`); return; } this.#inner = t; this.#emitter.emit('ws:update:parsed', { language: this.#language, platform: this.#platform, data: t, }); }; /** * Get the latest worldstate data from this cache * @returns {Object} Current worldstate data */ get data() { return this.#inner; } /** * Set the current data, aslso parses and emits data * @param {string} newData New string data to parse */ set data(newData) { logger.debug(`got new data for ${this.#language}, parsing...`); this.#update(newData); } /** * Set the current twitter data for the worldstate * @param {Object} newTwitter twitter data */ set twitter(newTwitter) { if (!(newTwitter &amp;&amp; newTwitter.length)) return; this.#inner.twitter = newTwitter; } } × Search results Close "},"handlers_Worldstate.js.html":{"id":"handlers_Worldstate.js.html","title":"Source: handlers/Worldstate.js","body":" Worldstate Emitter Classes module.exports Global arbitrationbetweendataemitfromNowgetgetDatagetParseableDatagroupByinitCycleStartlastUpdatedonErrorparseEventssetUpRawEmitterssetupParsedEventstwitterupdate Source: handlers/Worldstate.js import wsData from 'warframe-worldstate-data'; import WSCache from '../utilities/WSCache.js'; import { logger, lastUpdated } from '../utilities/index.js'; import Cache from '../utilities/Cache.js'; import { SENTIENT_URL, KUVA_URL, WORLDSTATE_URL } from '../resources/config.js'; import parseNew from './events/parse.js'; const { locales } = wsData; const debugEvents = ['arbitration', 'kuva', 'nightwave']; const smCron = `0 */10 * * * *`; /** * Handler for worldstate data */ export default class Worldstate { #emitter; #locale; #worldStates = {}; #wsRawCache; #kuvaCache; #sentientCache; /** * Set up listening for specific platform and locale if provided. * @param {EventEmitter} eventEmitter Emitter to push new worldstate events to * @param {string} locale Locale (actually just language) to watch */ constructor(eventEmitter, locale) { this.#emitter = eventEmitter; this.#locale = locale; logger.debug('starting up worldstate listener...'); if (locale) { logger.debug(`only listening for ${locale}...`); } } async init() { this.#wsRawCache = await Cache.make(WORLDSTATE_URL, '*/10 * * * * *'); this.#kuvaCache = await Cache.make(KUVA_URL, smCron); this.#sentientCache = await Cache.make(SENTIENT_URL, smCron); await this.setUpRawEmitters(); this.setupParsedEvents(); } /** * Set up emitting raw worldstate data */ async setUpRawEmitters() { this.#worldStates = {}; // eslint-disable-next-line no-restricted-syntax for await (const locale of locales) { if (!this.#locale || this.#locale === locale) { this.#worldStates[locale] = new WSCache({ language: locale, kuvaCache: this.#kuvaCache, sentientCache: this.#sentientCache, eventEmitter: this.#emitter, }); } } /* listen for the raw cache updates so we can emit them from the super emitter */ this.#wsRawCache.on('update', (dataStr) =&gt; { this.#emitter.emit('ws:update:raw', { platform: 'pc', data: dataStr }); }); /* when the raw emits happen, parse them and store them on parsed worldstate caches */ this.#emitter.on('ws:update:raw', ({ data }) =&gt; { logger.debug('ws:update:raw - updating locales data'); locales.forEach((locale) =&gt; { if (!this.#locale || this.#locale === locale) { this.#worldStates[locale].data = data; } }); }); } /** * Set up listeners for the parsed worldstate updates */ setupParsedEvents() { this.#emitter.on('ws:update:parsed', ({ language, platform, data }) =&gt; { const packet = { platform, worldstate: data, language }; this.parseEvents(packet); }); } /** * Parse new worldstate events * @param {Object} worldstate worldstate to find packets from * @param {string} platform platform the worldstate corresponds to * @param {string} [language='en'] language of the worldstate (defaults to 'en') */ parseEvents({ worldstate, platform, language = 'en' }) { const cycleStart = Date.now(); const packets = []; Object.keys(worldstate).forEach(async (key) =&gt; { if (worldstate &amp;&amp; worldstate[key]) { const packet = parseNew({ data: worldstate[key], key, language, platform, cycleStart, }); if (Array.isArray(packet)) { if (packet.length) { packets.push(...packet.filter((p) =&gt; p &amp;&amp; p)); } } else if (packet) { packets.push(packet); } } }); lastUpdated[platform][language] = Date.now(); packets .filter((p) =&gt; p &amp;&amp; p.id &amp;&amp; packets) .forEach((packet) =&gt; { this.emit('ws:update:event', packet); }); } /** * Emit an event with given id * @param {string} id Id of the event to emit * @param {Object} packet Data packet to emit */ emit(id, packet) { if (debugEvents.includes(packet.key)) logger.warn(packet.key); logger.debug(`ws:update:event - emitting ${packet.id}`); delete packet.cycleStart; this.#emitter.emit(id, packet); } /** * get a specific worldstate version * @param {string} [language='en'] Locale of the worldsttate * @returns {Object} Worldstate corresponding to provided data * @throws {Error} when the platform or locale aren't tracked and aren't updated */ get(language = 'en') { logger.debug(`getting worldstate ${language}...`); if (this.#worldStates?.[language]) { return this.#worldStates?.[language]?.data; } throw new Error(`Language (${language}) not tracked.\\nEnsure that the parameters passed are correct`); } } × Search results Close "},"handlers_Twitter.js.html":{"id":"handlers_Twitter.js.html","title":"Source: handlers/Twitter.js","body":" Worldstate Emitter Classes module.exports Global arbitrationbetweendataemitfromNowgetgetDatagetParseableDatagroupByinitCycleStartlastUpdatedonErrorparseEventssetUpRawEmitterssetupParsedEventstwitterupdate Source: handlers/Twitter.js import Twitter from 'twitter'; import toWatch from '../resources/tweeters.json' with { type: 'json' }; import { logger } from '../utilities/index.js'; import { twiClientInfo, TWITTER_TIMEOUT } from '../utilities/env.js'; const determineTweetType = (tweet) =&gt; { if (tweet.in_reply_to_status_id) { return 'reply'; } if (tweet.quoted_status_id) { return 'quote'; } if (tweet.retweeted_status) { return 'retweet'; } return 'tweet'; }; const parseAuthor = (tweet) =&gt; ({ name: tweet.user.name, handle: tweet.user.screen_name, url: `https://twitter.com/${tweet.user.screen_name}`, avatar: `${tweet.user.profile_image_url.replace('_normal.jpg', '.jpg')}`, }); const parseQuoted = (tweet, type) =&gt; tweet[type] ? { text: tweet[type].full_text, author: { name: tweet[type].user.name, handle: tweet[type].user.screen_name, }, } : undefined; const parseTweet = (tweets, watchable) =&gt; { const [tweet] = tweets; const type = determineTweetType(tweet); return { id: `twitter.${watchable.plain}.${type}`, uniqueId: String(tweets[0].id_str), text: tweet.full_text, url: `https://twitter.com/${tweet.user.screen_name}/status/${tweet.id_str}`, mediaUrl: tweet.entities.media ? tweet.entities.media[0].media_url : undefined, isReply: typeof tweet.in_reply_to_status_id !== 'undefined', author: parseAuthor(tweet), quote: parseQuoted(tweet, 'quoted_status'), retweet: parseQuoted(tweet, 'retweeted_status'), createdAt: new Date(tweet.created_at), }; }; /** * Twitter event handler */ export default class TwitterCache { /** * Create a new Twitter self-updating cache * @param {EventEmitter} eventEmitter emitter to push new tweets to */ constructor(eventEmitter) { this.emitter = eventEmitter; this.timeout = TWITTER_TIMEOUT; this.clientInfoValid = twiClientInfo.consumer_key &amp;&amp; twiClientInfo.consumer_secret &amp;&amp; twiClientInfo.bearer_token; this.initClient(twiClientInfo); } initClient(clientInfo) { try { if (this.clientInfoValid) { this.client = new Twitter(clientInfo); // don't attempt anything else if authentication fails this.toWatch = toWatch; this.currentData = undefined; this.lastUpdated = Date.now() - 60000; this.updateInterval = setInterval(() =&gt; this.update(), this.timeout); this.update(); } else { logger.warn(`Twitter client not initialized... invalid token: ${clientInfo.bearer_token}`); } } catch (err) { this.client = undefined; this.clientInfoValid = false; logger.error(err); } } /** * Force the cache to update * @returns {Promise} the currently updating promise. */ async update() { if (!this.clientInfoValid) return undefined; if (!this.toWatch) { logger.verbose('Not processing twitter, no data to watch.'); return undefined; } if (!this.client) { logger.verbose('Not processing twitter, no client to connect.'); return undefined; } this.updating = this.getParseableData(); return this.updating; } /** * Get data able to be parsed from twitter. * @returns {Promise.&lt;Array.&lt;Object&gt;&gt;} Tweets */ async getParseableData() { logger.silly('Starting Twitter update...'); const parsedData = []; try { await Promise.all( this.toWatch.map(async (watchable) =&gt; { const tweets = await this.client.get('statuses/user_timeline', { screen_name: watchable.acc_name, tweet_mode: 'extended', count: 1, }); const tweet = parseTweet(tweets, watchable); parsedData.push(tweet); if (tweet.createdAt.getTime() &gt; this.lastUpdated) { this.emitter.emit('tweet', tweet); } }) ); } catch (error) { this.onError(error); } this.lastUpdated = Date.now(); return parsedData; } /** * Handle errors that arise while fetching data from twitter * @param {Error} error twitter error */ onError(error) { if (error[0] &amp;&amp; error[0].code === 32) { this.clientInfoValid = false; logger.info('wiping twitter client data, could not authenticate...'); } else { logger.debug(JSON.stringify(error)); } } /** * Get the current data or a promise with the current data * @returns {Promise.&lt;Object&gt; | Object} either the current data * if it's not updating, or the promise returning the new data */ async getData() { if (!this.clientInfoValid) return undefined; if (this.updating) { return this.updating; } return this.currentData; } } × Search results Close "},"handlers_RSS.js.html":{"id":"handlers_RSS.js.html","title":"Source: handlers/RSS.js","body":" Worldstate Emitter Classes module.exports Global arbitrationbetweendataemitfromNowgetgetDatagetParseableDatagroupByinitCycleStartlastUpdatedonErrorparseEventssetUpRawEmitterssetupParsedEventstwitterupdate Source: handlers/RSS.js import RssFeedEmitter from 'rss-feed-emitter'; import feeds from '../resources/rssFeeds.json' with { type: 'json' }; import { logger } from '../utilities/index.js'; /** * RSS Emitter, leverages [rss-feed-emitter](https://npmjs.org/package/rss-feed-emitter) */ export default class RSS { /** * Set up emitting events for warframe forum entries * @param {EventEmitter} eventEmitter Emitter to send events from */ constructor(eventEmitter) { this.logger = logger; this.emitter = eventEmitter; this.feeder = new RssFeedEmitter({ userAgent: 'WFCD Feed Notifier', skipFirstLoad: true, }); feeds.forEach((feed) =&gt; { this.feeder.add({ url: feed.url, timeout: 30000 }); }); this.logger.debug('RSS Feed active'); this.start = Date.now(); this.feeder.on('error', this.logger.error.bind(this.logger)); this.feeder.on('new-item', this.handleNew.bind(this)); } handleNew(item) { try { if (Object.keys(item.image).length) { this.logger.debug(`Image: ${JSON.stringify(item.image)}`); } if (new Date(item.pubDate).getTime() &lt;= this.start) return; const feed = feeds.filter((feedEntry) =&gt; feedEntry.url === item.meta.link)[0]; let firstImg = ((item.description || '').match(/&lt;img.*src=\"(.*)\".*&gt;/i) || [])[1]; if (!firstImg) { firstImg = feed.defaultAttach; } else if (firstImg.startsWith('//')) { firstImg = firstImg.replace('//', 'https://'); } const rssSummary = { body: (item.description || '\\u200B').replace(/&lt;(?:.|\\n)*?&gt;/gm, '').replace(/\\n\\n+\\s*/gm, '\\n\\n'), url: item.link, timestamp: item.pubDate, description: item.meta.description, author: feed.author || { name: 'Warframe Forums', url: item['rss:link']['#'], icon_url: 'https://i.imgur.com/hE2jdpv.png', }, title: item.title, image: firstImg, id: feed.key, }; this.emitter.emit('rss', rssSummary); } catch (error) { this.logger.error(error); } } } × Search results Close "},"handlers_events_arrayLike.js.html":{"id":"handlers_events_arrayLike.js.html","title":"Source: handlers/events/arrayLike.js","body":" Worldstate Emitter Classes module.exports Global arbitrationbetweendataemitfromNowgetgetDatagetParseableDatagroupByinitCycleStartlastUpdatedonErrorparseEventssetUpRawEmitterssetupParsedEventstwitterupdate Source: handlers/events/arrayLike.js import { logger } from '../../utilities/index.js'; import checkOverrides from './checkOverrides.js'; import objectLike from './objectLike.js'; /** * arrayLike are all just arrays of objectLike * @param {Object} deps dependencies for processing * @param {Object[]} packets packets to emit * @returns {Object|Object[]} object(s) to emit from arrayLike processing */ export default (deps, packets) =&gt; { try { deps.data.forEach((arrayItem) =&gt; { const k = checkOverrides(deps.key, arrayItem); packets.push( objectLike(arrayItem, { ...deps, id: k, }) ); }); return packets; } catch (err) { logger.error(err); } }; × Search results Close "},"handlers_events_checkOverrides.js.html":{"id":"handlers_events_checkOverrides.js.html","title":"Source: handlers/events/checkOverrides.js","body":" Worldstate Emitter Classes module.exports Global arbitrationbetweendataemitfromNowgetgetDatagetParseableDatagroupByinitCycleStartlastUpdatedonErrorparseEventssetUpRawEmitterssetupParsedEventstwitterupdate Source: handlers/events/checkOverrides.js import * as eKeyOverrides from './eKeyOverrides.js'; /** * Find overrides for the provided key * @param {string} key worldsate field to find overrides * @param {Object} data data corresponding to the key from provided worldstate * @returns {string} overrided key */ export default (key, data) =&gt; { if (typeof eKeyOverrides[key] === 'string') { return eKeyOverrides[key]; } if (typeof eKeyOverrides[key] === 'function') { return eKeyOverrides[key](data); } return key; }; × Search results Close "},"handlers_events_kuva.js.html":{"id":"handlers_events_kuva.js.html","title":"Source: handlers/events/kuva.js","body":" Worldstate Emitter Classes module.exports Global arbitrationbetweendataemitfromNowgetgetDatagetParseableDatagroupByinitCycleStartlastUpdatedonErrorparseEventssetUpRawEmitterssetupParsedEventstwitterupdate Source: handlers/events/kuva.js import { logger, groupBy } from '../../utilities/index.js'; import objectLike from './objectLike.js'; /** * Process kuva fields * @param {Deps} deps dependencies for processing * @param {Object[]} packets packets to emit * @returns {Object|Object[]} object(s) to emit from kuva stuff */ export default (deps, packets) =&gt; { if (!deps.data) { logger.error('no kuva data'); return undefined; } const data = groupBy(deps.data, 'type'); Object.keys(data).forEach((type) =&gt; { deps = { ...deps, data: data[type], id: `kuva.${data[type][0].type.replace(/\\s/g, '').toLowerCase()}`, activation: data[type][0].activation, expiry: data[type][0].expiry, }; const p = objectLike(deps.data, deps); if (p) { packets.push(p); } }); return packets.filter((p) =&gt; p); }; × Search results Close "},"global.html":{"id":"global.html","title":"Global","body":" Worldstate Emitter Classes module.exports Global arbitrationbetweendataemitfromNowgetgetDatagetParseableDatagroupByinitCycleStartlastUpdatedonErrorparseEventssetUpRawEmitterssetupParsedEventstwitterupdate Global Members &lt;constant&gt; arbitration Parse an arbitration for its key Source: handlers/events/eKeyOverrides.js, line 27 &lt;constant&gt; between Validate that b is between a and c Source: utilities/index.js, line 50 data Get the latest worldstate data from this cache Source: utilities/WSCache.js, line 75 data Set the current data, aslso parses and emits data Source: utilities/WSCache.js, line 83 &lt;constant&gt; groupBy Group an array by a field value Source: utilities/index.js, line 29 &lt;constant&gt; lastUpdated :Object Map of last updated dates/times Type: Object Source: utilities/index.js, line 66 twitter Set the current twitter data for the worldstate Source: utilities/WSCache.js, line 92 Methods emit(id, packet) Emit an event with given id Parameters: Name Type Description id string Id of the event to emit packet Object Data packet to emit Source: handlers/Worldstate.js, line 135 fromNow(d [, now]) Returns the number of milliseconds between now and a given date Parameters: Name Type Argument Description d string The date from which the current time will be subtracted now function &lt;optional&gt; A function that returns the current UNIX time in milliseconds Source: utilities/index.js, line 58 Returns: Type number get( [language]) get a specific worldstate version Parameters: Name Type Argument Default Description language string &lt;optional&gt; 'en' Locale of the worldsttate Source: handlers/Worldstate.js, line 149 Throws: when the platform or locale aren't tracked and aren't updated Type Error Returns: Worldstate corresponding to provided data Type Object &lt;async&gt; getData() Get the current data or a promise with the current data Source: handlers/Twitter.js, line 161 Returns: either the current data if it's not updating, or the promise returning the new data Type Promise.&lt;Object&gt; | Object &lt;async&gt; getParseableData() Get data able to be parsed from twitter. Source: handlers/Twitter.js, line 117 Returns: Tweets Type Promise.&lt;Array.&lt;Object&gt;&gt; initCycleStart(deps) Set up current cycle start if it's not been initiated Parameters: Name Type Description deps Deps dependencies for processing Source: handlers/events/parse.js, line 24 onError(error) Handle errors that arise while fetching data from twitter Parameters: Name Type Description error Error twitter error Source: handlers/Twitter.js, line 147 parseEvents(worldstate, platform [, language]) Parse new worldstate events Parameters: Name Type Argument Default Description worldstate Object worldstate to find packets from platform string platform the worldstate corresponds to language string &lt;optional&gt; 'en' language of the worldstate (defaults to 'en') Source: handlers/Worldstate.js, line 99 &lt;async&gt; setUpRawEmitters() Set up emitting raw worldstate data Source: handlers/Worldstate.js, line 52 setupParsedEvents() Set up listeners for the parsed worldstate updates Source: handlers/Worldstate.js, line 86 &lt;async&gt; update() Force the cache to update Source: handlers/Twitter.js, line 95 Returns: the currently updating promise. Type Promise Type Definitions CycleLike Type: Object Properties: Name Type Description state string key string activation Date Source: handlers/events/cycleLike.js, line 3 Deps Type: Object Properties: Name Type Description key string event key being parsed platform string platform the event is on language string language the event is in cycleStart Date start of the current cycle data Object | Array data to parse Source: handlers/events/parse.js, line 11 ExternalMission External mission data retrieved from https://10o.io/kuvalog.json Type: Object Properties: Name Type Description activation Date start time expiry Date end timer node string formatted node name with planet enemy string Enemy on tile type string Mission type of node archwing boolean whether or not the tile requires archwing sharkwing boolean whether or not the tile requires sumbersible archwing Source: handlers/events/eKeyOverrides.js, line 3 × Search results Close "},"classes.list.html":{"id":"classes.list.html","title":"Classes","body":" Worldstate Emitter Classes module.exports Global arbitrationbetweendataemitfromNowgetgetDatagetParseableDatagroupByinitCycleStartlastUpdatedonErrorparseEventssetUpRawEmitterssetupParsedEventstwitterupdate Classes Members &lt;constant&gt; arbitration Parse an arbitration for its key Source: handlers/events/eKeyOverrides.js, line 27 &lt;constant&gt; between Validate that b is between a and c Source: utilities/index.js, line 50 data Get the latest worldstate data from this cache Source: utilities/WSCache.js, line 75 data Set the current data, aslso parses and emits data Source: utilities/WSCache.js, line 83 &lt;constant&gt; groupBy Group an array by a field value Source: utilities/index.js, line 29 &lt;constant&gt; lastUpdated :Object Map of last updated dates/times Type: Object Source: utilities/index.js, line 66 twitter Set the current twitter data for the worldstate Source: utilities/WSCache.js, line 92 Methods emit(id, packet) Emit an event with given id Parameters: Name Type Description id string Id of the event to emit packet Object Data packet to emit Source: handlers/Worldstate.js, line 135 fromNow(d [, now]) Returns the number of milliseconds between now and a given date Parameters: Name Type Argument Description d string The date from which the current time will be subtracted now function &lt;optional&gt; A function that returns the current UNIX time in milliseconds Source: utilities/index.js, line 58 Returns: Type number get( [language]) get a specific worldstate version Parameters: Name Type Argument Default Description language string &lt;optional&gt; 'en' Locale of the worldsttate Source: handlers/Worldstate.js, line 149 Throws: when the platform or locale aren't tracked and aren't updated Type Error Returns: Worldstate corresponding to provided data Type Object &lt;async&gt; getData() Get the current data or a promise with the current data Source: handlers/Twitter.js, line 161 Returns: either the current data if it's not updating, or the promise returning the new data Type Promise.&lt;Object&gt; | Object &lt;async&gt; getParseableData() Get data able to be parsed from twitter. Source: handlers/Twitter.js, line 117 Returns: Tweets Type Promise.&lt;Array.&lt;Object&gt;&gt; initCycleStart(deps) Set up current cycle start if it's not been initiated Parameters: Name Type Description deps Deps dependencies for processing Source: handlers/events/parse.js, line 24 onError(error) Handle errors that arise while fetching data from twitter Parameters: Name Type Description error Error twitter error Source: handlers/Twitter.js, line 147 parseEvents(worldstate, platform [, language]) Parse new worldstate events Parameters: Name Type Argument Default Description worldstate Object worldstate to find packets from platform string platform the worldstate corresponds to language string &lt;optional&gt; 'en' language of the worldstate (defaults to 'en') Source: handlers/Worldstate.js, line 99 &lt;async&gt; setUpRawEmitters() Set up emitting raw worldstate data Source: handlers/Worldstate.js, line 52 setupParsedEvents() Set up listeners for the parsed worldstate updates Source: handlers/Worldstate.js, line 86 &lt;async&gt; update() Force the cache to update Source: handlers/Twitter.js, line 95 Returns: the currently updating promise. Type Promise Type Definitions CycleLike Type: Object Properties: Name Type Description state string key string activation Date Source: handlers/events/cycleLike.js, line 3 Deps Type: Object Properties: Name Type Description key string event key being parsed platform string platform the event is on language string language the event is in cycleStart Date start of the current cycle data Object | Array data to parse Source: handlers/events/parse.js, line 11 ExternalMission External mission data retrieved from https://10o.io/kuvalog.json Type: Object Properties: Name Type Description activation Date start time expiry Date end timer node string formatted node name with planet enemy string Enemy on tile type string Mission type of node archwing boolean whether or not the tile requires archwing sharkwing boolean whether or not the tile requires sumbersible archwing Source: handlers/events/eKeyOverrides.js, line 3 × Search results Close "},"index.html":{"id":"index.html","title":"Index","body":" Worldstate Emitter Classes module.exports Global arbitrationbetweendataemitfromNowgetgetDatagetParseableDatagroupByinitCycleStartlastUpdatedonErrorparseEventssetUpRawEmitterssetupParsedEventstwitterupdate Worldstate Emitter Suuuper simple emitter for worldstate events. Very opinionated decisions on what events and event names, as well as.... everything else Emitter Events Emitter Event Emit key description RSS rss New forum post from DE Worldstate ws:update New Worldstate event Tweet tweet New tweet from one of the selected accounts Twitter Accounts Warframe (warframe) Digital Extremes (digitalextremes) [DE]Pablo (pablo) Cameron Rogers (cameron) [DE]Rebecca (rebecca) [DE]Steve (steve) [DE]Danielle (danielle) [DE]Megan (megan) [DE]George (george) [DE]Maciej (maciej) [DE]Sheldon (sheldon) [DE]Marcus (narc) [DE]Helen (helen) Tobiah (me) (tobiah) WF Discord (wfdiscord) Twitter Events tweet retweet reply quote RSS Feeds Players helping Players PC Updates PC Announcements PS4 Updates PS4 Announcements XB1 Updates XB1 Announcements Switch Updates Switch Announcements News Developers Workshop Staff Replies [DE]Rebecca [DE]Danielle [DE]Drew [DE]Glen [DE]Taylor [DE]Steve [DE]Helen [DE]Saske [DE]Kaz [DE]Pablo [DE]Connor [DE]Marcus [DE]George [DE]Bear Other Methods Method Params Output getRss -- Map of RSS feeds with url and items getWorldstate platform, locale Worldstate objects -- platform Defaults to pc. One of pc, ps4, xb1, swi. -- locale Defaults to en. Any of the locales included in worldstate-data * Denote required Help &amp; Contact × Search results Close "},"module.html#.exports":{"id":"module.html#.exports","title":"Class: exports","body":" Worldstate Emitter Classes module.exports Global arbitrationbetweendataemitfromNowgetgetDatagetParseableDatagroupByinitCycleStartlastUpdatedonErrorparseEventssetUpRawEmitterssetupParsedEventstwitterupdate Class: exports exports RSS Emitter, leverages [rss-feed-emitter](https://npmjs.org/package/rss-feed-emitter) new exports(eventEmitter) Set up emitting events for warframe forum entries Parameters: Name Type Description eventEmitter EventEmitter Emitter to send events from Source: handlers/RSS.js, line 9 Class: exports exports Twitter event handler new exports(eventEmitter) Create a new Twitter self-updating cache Parameters: Name Type Description eventEmitter EventEmitter emitter to push new tweets to Source: handlers/Twitter.js, line 58 Class: exports exports Handler for worldstate data new exports(eventEmitter, locale) Set up listening for specific platform and locale if provided. Parameters: Name Type Description eventEmitter EventEmitter Emitter to push new worldstate events to locale string Locale (actually just language) to watch Source: handlers/Worldstate.js, line 18 Class: exports exports Warframe WorldState Cache - store and retrieve current worldstate data new exports(language, kuvaCache, sentientCache, eventEmitter) Set up a cache checking for data and updates to a specific worldstate set Parameters: Name Type Description language string Language/translation to track kuvaCache Cache Cache of kuva data, provided by Semlar sentientCache Cache Cache of sentient outpost data, provided by Semlar eventEmitter EventEmitter Emitter to push new worldstate updates to Source: utilities/WSCache.js, line 8 × Search results Close "}}
    </script>

    <script type="text/javascript">
        $(document).ready(function() {
            Searcher.init();
        });

        $(window).on("message", function(msg) {
            var msgData = msg.originalEvent.data;

            if (msgData.msgid != "docstrap.quicksearch.start") {
                return;
            }

            var results = Searcher.search(msgData.searchTerms);

            window.parent.postMessage({"results": results, "msgid": "docstrap.quicksearch.done"}, "*");
        });
    </script>
</body>
</html>
